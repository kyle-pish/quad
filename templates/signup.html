<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='login.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='universal.css') }}">
    <style>
        #main-content {
            margin-top: 1rem;
        }
    </style>
</head>

<body>
    <section>
        <div class="container">
            <img id="logo" src="/static/imgs/logo.png" height="120" width="120" alt="">
            <p id="about" class="text-center mt-0">A Fun Little Social App</p>
            <main>
                <h1>Sign Up</h1>
                {% if errors %}
                    <div style="color: #ff4d4d; font-weight: bold; margin-bottom: 1em;">
                        <ul style="margin:0; padding-left:1.2em;">
                        {% for error in errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                <form action="/signup" method="post">
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required><br><br>
                    <label for="username">Username:</label>
                    <input type="text" id="username" name="username" required><br>
                    <span id="username-status" style="font-size:0.9em;color:#ff4d4d;font-weight:bold;display:none;"></span>
                    <ul id="username-reqs" style="font-size:0.7em; color:#aaa; margin:0 0 1em 1.5em; padding-left:1em;">
                        <li id="uname-len">4-32 characters</li>
                        <li id="uname-chars">Letters, numbers, underscores (_), hyphens (-), and periods (.) only</li>
                    </ul>
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" required><br>
                    <ul id="password-reqs" style="font-size:0.7em; color:#aaa; margin:0 0 1em 1.5em; padding-left:1em;">
                        <li id="pw-len">At least 12 characters</li>
                        <li id="pw-lower">Must include a lowercase letter</li>
                        <li id="pw-upper">Must include an uppercase letter</li>
                        <li id="pw-num">Must include a number</li>
                        <li id="pw-special">Must include a special character</li>
                    </ul>
                    <label for="age">Age:</label>
                    <input type="number" id="age" name="age" required><br><br>
                    <label for="college">College:</label>
                    <select id="college" name="college" required>
                        <option value="">Select your college</option>
                        <option value="Illinois State University">Illinois State University</option>
                        <option value="Illinois Wesleyan University">Illinois Wesleyan University</option>
                    </select><br><br>
                    <input type="submit" value="Sign Up">
                </form>
                <p>Already have an account? <a href="/">Login</a></p>
            </main>
        </div>
    </section>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    const usernameInput = document.getElementById('username');
    const statusSpan = document.getElementById('username-status');
    let lastValue = '';
    usernameInput.addEventListener('input', function() {
        const value = usernameInput.value.trim();
        // Username requirements
        document.getElementById('uname-len').style.color = (value.length >= 4 && value.length <= 32) ? 'limegreen' : '#aaa';
        document.getElementById('uname-chars').style.color = /^[A-Za-z0-9_.-]+$/.test(value) ? 'limegreen' : '#aaa';
        if (value.length < 4) {
            statusSpan.style.display = 'none';
            return;
        }
        if (value === lastValue) return;
        lastValue = value;
        fetch('/check_username', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: 'username=' + encodeURIComponent(value)
        })
        .then(response => response.json())
        .then(data => {
            if (!data.available) {
                statusSpan.textContent = 'Username is unavailable.';
                statusSpan.style.display = 'inline';
            } else {
                statusSpan.textContent = '';
                statusSpan.style.display = 'none';
            }
        });
    });
    // Password requirements
    const passwordInput = document.getElementById('password');
    passwordInput.addEventListener('input', function() {
        const value = passwordInput.value;
        document.getElementById('pw-len').style.color = value.length >= 12 ? 'limegreen' : '#aaa';
        document.getElementById('pw-lower').style.color = /[a-z]/.test(value) ? 'limegreen' : '#aaa';
        document.getElementById('pw-upper').style.color = /[A-Z]/.test(value) ? 'limegreen' : '#aaa';
        document.getElementById('pw-num').style.color = /[0-9]/.test(value) ? 'limegreen' : '#aaa';
        document.getElementById('pw-special').style.color = /[^A-Za-z0-9]/.test(value) ? 'limegreen' : '#aaa';
    });
});
</script>
</body>

</html>
